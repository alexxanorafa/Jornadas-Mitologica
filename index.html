<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Jornada Mitológica</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <nav aria-label="Menu principal">
      <button
        id="menuIcon"
        class="menu-icon"
        aria-label="Abrir menu de aplicações"
        aria-expanded="false"
        aria-controls="menu"
        type="button"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>

      <div id="menu" class="menu" role="dialog" aria-modal="true" aria-labelledby="menuTitle">
        <h2 id="menuTitle" class="menu-title">Ecossistema Oracular</h2>
              <nav class="menu" id="menu">
          <ul class="menu-items" id="menuItems">
            <a href="https://alexxanorafa.github.io/ecosystem/" class="menu-item">Voltar ao Ecosystem</a>
        </ul>
      </nav>
  </header>

  <div class="main-shell">
    <!-- SCREEN 0 – RODA DA FORTUNA -->
    <section id="screen-wheel" class="screen">
      <h1>Jornada Mitológica</h1>
      <h3>Roda da Fortuna Mitológica – escolhe, contigo, a cultura que te chama hoje.</h3>

      <div class="screen-content">
        <canvas id="wheel-canvas" aria-label="Roda da Fortuna das culturas mitológicas"></canvas>

        <p id="wheel-result">Clique para iniciar a jornada.</p>

        <div style="margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
          <button id="btn-wheel-spin" class="btn btn-primary" type="button">
            Iniciar Jornada
          </button>
          <button id="btn-wheel-next" class="btn btn-secondary" type="button" onclick="document.dispatchEvent(new Event('jmNextFromWheel'))">
            Prosseguir para a tiragem
          </button>
        </div>
      </div>
    </section>

    <!-- SCREEN 1 – CONFIGURAÇÃO DA TIRAGEM -->
    <section id="screen-setup" class="screen hidden">
      <h2>Escolhe a tiragem</h2>
      <h3>Define quantas cartas e que camada arquetípica desejas explorar.</h3>

      <div class="screen-content">
        <div class="setup-group">
          <label for="select-num-cartas" class="setup-label">Número de cartas</label>
          <select id="select-num-cartas" class="setup-select">
            <option value="1">1 carta – Foco do momento</option>
            <option value="2">2 cartas – Polaridades</option>
            <option value="3" selected>3 cartas – Passado / Presente / Potencial</option>
            <option value="5">5 cartas – Situação / Desafio / Recurso / Sombra / Direção</option>
            <option value="7">7 cartas – Jornada arquetípica</option>
            <option value="9">9 cartas – Mandala interior</option>
            <option value="12">12 cartas – Ciclo expandido</option>
          </select>
        </div>

        <div class="setup-group">
          <label for="select-tipo-baralho" class="setup-label">Tipo de baralho</label>
          <select id="select-tipo-baralho" class="setup-select">
            <option value="maiores" selected>Deuses / Arcanos Maiores</option>
            <option value="menores">Cenas / Arcanos Menores</option>
            <option value="mistos">Mistos (Maiores + Menores)</option>
          </select>
        </div>

        <div style="display: flex; gap: 10px; margin-top: 16px; flex-wrap: wrap; justify-content: center;">
          <button id="btn-help-tiragem" class="btn btn-ghost" type="button">
            ?
          </button>
          <button id="btn-ir-tiragem" class="btn btn-primary" type="button">
            Sortear tiragem
          </button>
        </div>
      </div>
    </section>

    <!-- SCREEN 2 – GRELHA DA TIRAGEM -->
    <section id="screen-spread" class="screen hidden">
      <h2>Cartas em jogo</h2>
      <h3>Explora a disposição e aprofunda o diálogo com cada arquétipo.</h3>

      <div class="screen-content">
        <div class="spread-grid-wrapper">
          <div id="spread-grid" aria-label="Grelha de cartas da tiragem"></div>
        </div>

        <div class="spread-focus">
          <div class="spread-focus-header">
            <div id="spread-focus-name">Nome da carta</div>
            <div id="spread-focus-arquetipo">Arquétipo</div>
          </div>

          <div class="spread-focus-pergunta" id="spread-focus-pergunta">
            Pergunta da posição.
          </div>

          <div class="spread-focus-text" id="spread-focus-texto">
            Interpretação arquetípica da carta nesta posição.
          </div>

          <div class="spread-actions">
            <button id="btn-descricao-completa" class="btn btn-secondary" type="button">
              Ver mitologia completa
            </button>
            <button id="btn-nova-tiragem" class="btn btn-ghost" type="button">
              Nova tiragem
            </button>
            <button id="btn-ir-resumo" class="btn btn-primary" type="button">
              Ver síntese
            </button>
          </div>

          <div class="spread-resumo-wrapper">
            <strong>Resumo arquetípico da tiragem:</strong>
            <div id="spread-resumo">
              A síntese da tiragem será apresentada aqui.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SCREEN 3 – RESUMO / DIÁRIO -->
    <section id="screen-summary" class="screen hidden">
      <h2>Síntese da jornada</h2>
      <h3>Integra a leitura e regista o que ressoa.</h3>

      <div class="screen-content">
        <div class="summary-block">
          <div id="summary-texto">
            A síntese narrativa da tiragem será apresentada aqui.
          </div>

          <label for="summary-notas" class="summary-notes-label">
            Notas pessoais (guardadas no teu dispositivo)
          </label>
          <textarea id="summary-notas" rows="5"></textarea>

          <div class="summary-actions">
            <button id="summary-salvar" class="btn btn-secondary" type="button">
              Guardar notas
            </button>
            <button id="summary-voltar-inicio" class="btn btn-primary" type="button">
              Voltar à Roda
            </button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- MODAL: Ajuda sobre tiragens -->
  <div id="modal-help-tiragem" class="modal-backdrop hidden" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-help-tiragem-titulo">
      <div class="modal-header">
        <h3 id="modal-help-tiragem-titulo" class="modal-title">Sobre os tipos de tiragem</h3>
        <button id="modal-help-tiragem-fechar" class="modal-close" type="button" aria-label="Fechar">
          ×
        </button>
      </div>
      <div class="modal-body">
        <p>
          Cada formato de tiragem representa uma forma diferente de mapear a tua jornada:
        </p>
        <ul style="margin-top: 8px; padding-left: 16px; font-size: 0.9rem;">
          <li>1 carta – foco do momento, um único arquétipo em evidência.</li>
          <li>2 cartas – polaridades e tensões entre dois movimentos internos.</li>
          <li>3 cartas – linha do tempo: passado, presente e potencial.</li>
          <li>5 cartas – mapa da situação: cenário, desafio, recurso, sombra e direção.</li>
          <li>7+ cartas – jornadas mais extensas, para aprofundar camadas da experiência.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- MODAL: Mitologia completa da carta -->
  <div id="modal-descricao-completa" class="modal-backdrop hidden" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-descricao-titulo">
      <div class="modal-header">
        <h3 id="modal-descricao-titulo" class="modal-title">Mitologia e arquétipo</h3>
        <button id="modal-descricao-fechar" class="modal-close" type="button" aria-label="Fechar">
          ×
        </button>
      </div>
      <div class="modal-body">
        <div id="modal-descricao-texto">
          O texto completo da carta será apresentado aqui.
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>

  <script>
    // Passo da Roda -> Setup, respeitando o estado definido no script.js
    document.addEventListener('jmNextFromWheel', function () {
      if (typeof mostrarScreen === 'function') {
        mostrarScreen('screen-setup');
      }
    });
  </script>
</body>

</html>
